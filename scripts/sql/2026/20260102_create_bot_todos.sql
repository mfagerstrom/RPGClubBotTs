CREATE TABLE RPG_CLUB_TODOS (
  TODO_ID        NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY PRIMARY KEY,
  TITLE          VARCHAR2(200) NOT NULL,
  DETAILS        VARCHAR2(2000),
  CREATED_BY     VARCHAR2(30),
  CREATED_AT     TIMESTAMP WITH TIME ZONE DEFAULT SYSTIMESTAMP NOT NULL,
  UPDATED_AT     TIMESTAMP WITH TIME ZONE DEFAULT SYSTIMESTAMP NOT NULL,
  COMPLETED_AT   TIMESTAMP WITH TIME ZONE,
  COMPLETED_BY   VARCHAR2(30),
  IS_COMPLETED   NUMBER(1,0) DEFAULT 0 NOT NULL
);

CREATE INDEX IX_RPG_CLUB_TODOS_STATUS ON RPG_CLUB_TODOS (IS_COMPLETED, CREATED_AT);

CREATE OR REPLACE TRIGGER TRG_RPG_CLUB_TODOS_UPD
BEFORE UPDATE ON RPG_CLUB_TODOS
FOR EACH ROW
BEGIN
  :NEW.UPDATED_AT := SYSTIMESTAMP;
END;
/

commit;
